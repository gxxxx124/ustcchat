# NSRLChat 认证系统使用说明

## 🎉 功能完成！

您的NSRLChat现在已经成功集成了完整的用户认证系统！

## 🚀 快速启动

```bash
# 进入项目目录
cd /home/user/ustcchat/ustc

# 启动应用（自动检查环境并初始化）
./start_nsrlchat.sh
```

## 📱 访问地址

- **登录页面**: http://localhost:8000/auth/login-page
- **管理员页面**: http://localhost:8000/auth/admin  
- **主应用**: http://localhost:8000/

## 🔑 默认账号

- **用户名**: `admin`
- **密码**: `admin123`

⚠️ **重要**: 首次登录后请立即修改默认密码！

## ✨ 新增功能

### 1. 用户认证
- ✅ 用户登录/登出
- ✅ JWT令牌认证
- ✅ 自动重定向到登录页面
- ✅ 会话管理

### 2. 管理员功能
- ✅ 添加新用户
- ✅ 查看用户列表
- ✅ 删除用户
- ✅ 设置管理员权限

### 3. 安全保护
- ✅ API访问保护
- ✅ 页面访问控制
- ✅ 密码加密存储
- ✅ 令牌过期机制

## 🛠️ 管理员操作

### 添加新用户
1. 访问 http://localhost:8000/auth/admin
2. 使用管理员账号登录
3. 填写用户信息：
   - 用户名（必填）
   - 密码（必填）
   - 邮箱（可选）
   - 管理员权限（可选）
4. 点击"添加用户"

### 管理现有用户
- 在用户列表中查看所有用户
- 点击"删除"按钮删除不需要的用户
- 不能删除自己的账号

## 🔒 安全特性

- **密码加密**: 使用SHA-256加密存储
- **令牌认证**: 自定义JWT替代方案
- **会话管理**: 30分钟自动过期
- **权限控制**: 管理员和普通用户分离

## 📋 系统要求

- PostgreSQL 数据库
- Qdrant 向量数据库
- Python 3.12+ (miniconda环境)

## 🐛 故障排除

### 无法登录
1. 检查用户名和密码是否正确
2. 确认用户账号是否存在
3. 查看应用日志: `tail -f logs/app.log`

### 权限不足
1. 确认用户是否有管理员权限
2. 检查JWT令牌是否有效
3. 尝试重新登录

### 数据库连接失败
1. 确认PostgreSQL服务正在运行
2. 检查数据库连接配置
3. 确认数据库用户权限

## 📞 技术支持

如有问题，请查看：
- 应用日志: `logs/app.log`
- 聊天日志: `logs/chat_flow.log`
- 认证说明: `AUTH_README.md`

---

🎊 **恭喜！您的NSRLChat现在拥有了完整的用户认证系统！**
